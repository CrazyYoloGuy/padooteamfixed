â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    QUICK DEPLOYMENT CHECKLIST                              â•‘
â•‘                  (Copy & Paste This Into Your Terminal)                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: UPLOAD FILES TO VPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Upload these files to your VPS:
  âœ“ server.js (with BUILD_TIMESTAMP and cache headers)
  âœ“ sw.js (with dynamic cache name)
  âœ“ pwa-utils.js (with version checking)
  âœ“ mainapp/delivery/js/app.js (your app changes)
  âœ“ Any other modified files


STEP 2: SSH INTO VPS AND RESTART SERVER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ssh your-vps-user@your-vps-ip

# Stop the old server
pm2 stop server

# Start the new server
pm2 start server.js

# Verify it's running
pm2 logs server

# You should see:
# ğŸš€ Server starting with BUILD_VERSION: v2025-11-11T...


STEP 3: VERIFY ON DESKTOP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1. Open your app in browser
2. Hard refresh: Ctrl+Shift+R (Windows) or Cmd+Shift+R (Mac)
3. Open console: F12
4. Look for: "âœ… App is up to date"
5. Test: Accept order, check time updates, verify layout


STEP 4: VERIFY ON MOBILE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
OPTION A: Hard Refresh (Fastest)
  1. Open app on mobile
  2. Hard refresh: Ctrl+Shift+R or Cmd+Shift+R
  3. Open console: F12
  4. Look for: "âœ… App is up to date"

OPTION B: Clear Cache (If Hard Refresh Doesn't Work)
  iOS:
    1. Settings â†’ Safari â†’ Clear History and Website Data
    2. Refresh app
  
  Android:
    1. Settings â†’ Apps â†’ Your App â†’ Storage â†’ Clear Cache
    2. Refresh app

OPTION C: Uninstall & Reinstall PWA (Nuclear Option)
  iOS:
    1. Home Screen â†’ Long press app â†’ Remove
    2. Open app in Safari
    3. Share â†’ Add to Home Screen
  
  Android:
    1. Long press app â†’ Uninstall
    2. Open app in Chrome
    3. Menu â†’ Install app


STEP 5: FINAL VERIFICATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ“ Accept order â†’ stays on current page (not redirected)
âœ“ Time updates â†’ every minute without refresh
âœ“ Layout â†’ symmetric and properly aligned
âœ“ No console errors
âœ“ Works on desktop
âœ“ Works on mobile


TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Problem: Changes not showing
Solution: 
  1. Clear cache (see OPTION B or C above)
  2. Hard refresh: Ctrl+Shift+R
  3. Check console for errors: F12

Problem: Old Service Worker still active
Solution:
  1. DevTools â†’ Application â†’ Service Workers
  2. Click "Unregister" on old workers
  3. Hard refresh
  4. New SW should register automatically

Problem: Stuck on old version
Solution:
  1. Clear browser cache completely
  2. Clear app storage
  3. Restart browser/app
  4. Hard refresh


WHAT CHANGED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ“ server.js
  - Added BUILD_TIMESTAMP (generated on every start)
  - Added BUILD_VERSION (generated on every start)
  - Added Cache-Control headers to prevent caching
  - Added /api/version endpoint

âœ“ sw.js
  - Changed CACHE_NAME to use Date.now() (unique per deployment)
  - Updated activate event to delete ALL old caches
  - Added aggressive cache cleanup

âœ“ pwa-utils.js
  - Added checkServerVersion() method
  - Checks version on app load
  - Clears caches and reloads if version mismatch


KEY POINTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âš ï¸  EVERY TIME YOU RUN: pm2 start server.js
    â†’ NEW BUILD_TIMESTAMP is generated
    â†’ Service Worker cache is invalidated
    â†’ All old caches are deleted
    â†’ Clients automatically reload if version changed

âœ…  THIS ENSURES: Updates work immediately with ZERO caching issues!


NEED HELP?
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1. Check server logs: pm2 logs server
2. Check browser console: F12
3. Check Network tab for cache headers
4. Verify /api/version returns correct timestamp
5. Read: DEPLOYMENT_CACHE_BUSTING_GUIDE.md

